<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>17.3 ‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏™‡∏ñ‡∏¥‡∏ï (‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)</title>
  <meta name="description" content="‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•, ‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏û‡∏≤‡∏™‡∏Ñ‡∏±‡∏•, ‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏£‡πå‡∏Ñ‡∏¥‡∏°‡∏µ‡∏î‡∏µ‡∏™" />
  <meta name="theme-color" content="#5b6fe6" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            thai: ['Sarabun', 'sans-serif']
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'Sarabun', 'sans-serif'; }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    input[type="range"] {
        -webkit-appearance: none; appearance: none;
        width: 100%; height: 8px;
        background: #d1d5db; border-radius: 5px;
        outline: none; opacity: 0.7;
        transition: opacity .2s;
    }
    input[type="range"]:hover { opacity: 1; }
    input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none; appearance: none;
        width: 20px; height: 20px;
        background: #3b82f6; cursor: pointer;
        border-radius: 50%;
    }
    input[type="range"]::-moz-range-thumb {
        width: 20px; height: 20px;
        background: #3b82f6; cursor: pointer;
        border-radius: 50%;
    }
    input[type=number]::-webkit-inner-spin-button, 
    input[type=number]::-webkit-outer-spin-button { 
      -webkit-appearance: none; 
      margin: 0; 
    }
    input[type=number] {
      -moz-appearance: textfield;
    }
    .material-btn {
        transition: all 0.2s ease-in-out;
    }
    .material-btn-active {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(59, 130, 246, 0.5);
        background-color: #3b82f6;
        color: white;
    }
    .equation-box {
        background-color: #f3f4f6;
        padding: 1rem;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: 'Times New Roman', Times, serif;
        font-size: 1.25rem;
    }
    .fraction {
        display: inline-flex;
        flex-direction: column;
        text-align: center;
        vertical-align: middle;
        margin: 0 0.5rem;
    }
    .fraction > span {
        padding: 0 0.5rem;
    }
    .fraction > hr {
        border-color: currentColor;
        border-width: 1px;
        margin: 0.1rem 0;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-900">
  <!-- Navigation -->
  <nav class="gradient-bg text-white shadow-lg sticky top-0 z-50" role="navigation" aria-label="‡∏´‡∏•‡∏±‡∏Å">
    <div class="container mx-auto px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center" aria-hidden="true">
          <span class="text-2xl">‚öñÔ∏è</span>
        </div>
        <h1 class="text-lg sm:text-xl font-bold">17.3 ‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏™‡∏ñ‡∏¥‡∏ï</h1>
      </div>
      <a href="index.html" class="text-sm font-semibold hover:text-blue-200 transition-colors">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
    </div>
  </nav>

  <main class="container mx-auto px-4 py-8 sm:py-12">
    <div class="max-w-4xl mx-auto bg-white p-4 sm:p-8 rounded-lg shadow-lg space-y-12">
      
      <!-- Section 1: Fluid Pressure -->
      <div>
        <h2 class="text-3xl font-bold text-purple-700 mb-6">17.3.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•</h2>
        <p class="mb-4">
          <strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô (Pressure, P)</strong> ‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏£‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ï‡∏±‡πâ‡∏á‡∏â‡∏≤‡∏Å‡∏ï‡πà‡∏≠‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (P = F/A) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏¥‡πà‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô ‡∏ì ‡∏à‡∏∏‡∏î‡πÉ‡∏î‡πÜ ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (h) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏• (œÅ)
        </p>
        <div class="equation-box my-4">
            <span>P</span><sub class="text-base">‡πÄ‡∏Å‡∏à</sub>&nbsp;=&nbsp;<em>œÅgh</em>
        </div>
        <!-- SIMULATION: Fluid Pressure -->
        <div class="mt-8 bg-white border border-gray-200 rounded-lg shadow-md p-4 sm:p-6">
            <h4 class="text-xl font-semibold mb-6 text-blue-600">üî¨ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•</h4>
            <div class="flex flex-col lg:flex-row lg:gap-6">
                <!-- Controls -->
                <div class="lg:w-1/3 lg:order-2 bg-white p-4 sm:p-6 rounded-xl shadow-inner mb-6 lg:mb-0">
                    <div class="space-y-4">
                        <div>
                            <label for="densitySlider" class="font-medium text-sm mb-1 block">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô (œÅ)</label>
                            <div class="flex items-center gap-2">
                                <input type="range" id="densitySlider" min="100" max="14000" value="1000" step="50" class="flex-grow">
                                <input type="number" id="densityNumber" min="100" max="14000" value="1000" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                                <span class="text-xs text-gray-500">kg/m¬≥</span>
                            </div>
                        </div>
                        <div>
                            <label for="depthSlider" class="font-medium text-sm mb-1 block">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (h)</label>
                            <div class="flex items-center gap-2">
                                <input type="range" id="depthSlider" min="0" max="100" value="10" step="1" class="flex-grow">
                                <input type="number" id="depthNumber" min="0" max="100" value="10" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                                <span class="text-xs text-gray-500">m</span>
                            </div>
                        </div>
                    </div>
                    <hr class="my-6">
                    <div class="text-center p-3 bg-blue-50 rounded-lg">
                        <h4 class="font-bold text-blue-700">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÄ‡∏Å‡∏à (P)</h4>
                        <p id="pressureDisplay" class="font-semibold text-2xl mt-1">98.10 kPa</p>
                    </div>
                    <div class="mt-6 space-y-2">
                        <button id="calculatePressureBtn" class="w-full text-center py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg transition text-base">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</button>
                        <div class="flex gap-2">
                            <button id="clearPressureGraphBtn" class="w-1/2 text-center py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-800 font-bold rounded-lg transition text-sm">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü</button>
                            <button id="exportPressureCsvBtn" class="w-1/2 text-center py-2 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition text-sm">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
                        </div>
                    </div>
                </div>
                <!-- Visuals -->
                <div class="lg:w-2/3 lg:order-1 space-y-4 lg:space-y-6">
                    <div class="w-full flex items-center justify-center bg-white p-4 rounded-xl shadow-inner h-72 sm:h-80 lg:min-h-[350px]">
                        <canvas id="pressureCanvas"></canvas>
                    </div>
                    <div class="w-full bg-white p-2 sm:p-4 rounded-xl shadow-inner h-64 sm:h-72">
                        <canvas id="pressureChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
      </div>

      <hr class="my-8">

      <!-- Section 2: Pascal's Principle -->
      <div>
        <h2 class="text-3xl font-bold text-purple-700 mb-6">‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏û‡∏≤‡∏™‡∏Ñ‡∏±‡∏•</h2>
         <p class="mb-4">
          "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πà‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏¥‡πà‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏ä‡∏ô‡∏∞‡∏õ‡∏¥‡∏î ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏∏‡∏Å‡πÜ ‡∏à‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡πÅ‡∏•‡∏∞‡∏ú‡∏ô‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏ä‡∏ô‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡∏ñ‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô"
        </p>
        <div class="equation-box my-4">
            <div class="fraction"><span>F</span><hr><span>a</span></div>
            <span>=</span>
            <div class="fraction"><span>W</span><hr><span>A</span></div>
        </div>
        <!-- SIMULATION: Pascal's Law -->
        <div class="mt-8 bg-white border border-gray-200 rounded-lg shadow-md p-4 sm:p-6">
            <h4 class="text-xl font-semibold mb-6 text-blue-600">üî¨ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á: ‡∏Å‡∏é‡∏Ç‡∏≠‡∏á‡∏û‡∏≤‡∏™‡∏Ñ‡∏±‡∏•</h4>
            <div class="flex flex-col lg:flex-row lg:gap-6">
                <!-- Controls -->
                <div class="lg:w-1/3 lg:order-2 bg-white p-4 sm:p-6 rounded-xl shadow-inner mb-6 lg:mb-0">
                    <div class="space-y-4">
                        <div>
                            <label for="f_slider" class="font-medium text-sm mb-1 block">‡πÅ‡∏£‡∏á‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤ (F)</label>
                             <div class="flex items-center gap-2">
                                <input type="range" id="f_slider" min="0" max="500" value="100" step="1" class="flex-grow">
                                <input type="number" id="f_number" min="0" max="500" value="100" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                                <span class="text-xs text-gray-500">N</span>
                            </div>
                        </div>
                        <div>
                            <label for="d_small_slider" class="font-medium text-sm mb-1 block">‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å (d)</label>
                             <div class="flex items-center gap-2">
                                <input type="range" id="d_small_slider" min="0.5" max="5" value="1.5" step="0.1" class="flex-grow">
                                <input type="number" id="d_small_number" min="0.5" max="5" value="1.5" step="0.1" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                                <span class="text-xs text-gray-500">cm</span>
                            </div>
                        </div>
                        <div>
                            <label for="D_large_slider" class="font-medium text-sm mb-1 block">‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà (D)</label>
                             <div class="flex items-center gap-2">
                                <input type="range" id="D_large_slider" min="1" max="15" value="3" step="0.1" class="flex-grow">
                                <input type="number" id="D_large_number" min="1" max="15" value="3" step="0.1" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                                <span class="text-xs text-gray-500">cm</span>
                            </div>
                        </div>
                    </div>
                    <hr class="my-6">
                    <div id="results" class="grid grid-cols-2 gap-3 sm:gap-4 text-xs">
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <h4 class="font-bold">‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏™‡∏π‡∏ö‡πÄ‡∏•‡πá‡∏Å</h4>
                            <p>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (a): <span id="a_val" class="font-semibold block">0 m¬≤</span></p>
                        </div>
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <h4 class="font-bold">‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡∏™‡∏π‡∏ö‡πÉ‡∏´‡∏ç‡πà</h4>
                            <p>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (A): <span id="A_val" class="font-semibold block">0 m¬≤</span></p>
                        </div>
                         <div class="col-span-2 text-center p-2 bg-gray-50 rounded-lg">
                             <h4 class="font-bold">‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô (P)</h4>
                             <p id="p_val" class="font-semibold text-base">0 kPa</p>
                        </div>
                         <div class="col-span-2 text-center p-3 bg-green-50 rounded-lg space-y-1">
                            <h4 class="font-bold text-green-700">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h4>
                            <p class="text-sm">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÑ‡∏î‡πâ (W): <span id="W_val" class="font-semibold">0 N</span></p>
                            <p class="text-sm">‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏• (M.A.): <span id="ma_val" class="font-semibold">0</span></p>
                        </div>
                    </div>
                    <div class="mt-6 space-y-2">
                        <button id="calculatePascalBtn" class="w-full text-center py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg transition text-base">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</button>
                        <div class="flex gap-2">
                            <button id="clearPascalGraphBtn" class="w-1/2 text-center py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-800 font-bold rounded-lg transition text-sm">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü</button>
                            <button id="exportPascalCsvBtn" class="w-1/2 text-center py-2 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition text-sm">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
                        </div>
                    </div>
                </div>
                <!-- Visuals -->
                <div class="lg:w-2/3 lg:order-1 space-y-4 lg:space-y-6">
                    <div class="w-full flex items-center justify-center bg-white p-4 rounded-xl shadow-inner h-72 sm:h-80 lg:min-h-[350px]">
                        <canvas id="pascalCanvas"></canvas>
                    </div>
                    <div class="w-full bg-white p-2 sm:p-4 rounded-xl shadow-inner h-64 sm:h-72">
                        <canvas id="pascalChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
      </div>

      <hr class="my-8">

      <!-- Section 3: Buoyancy -->
      <div>
        <h2 class="text-3xl font-bold text-purple-700 mb-6">17.3.3 ‡πÅ‡∏£‡∏á‡∏û‡∏¢‡∏∏‡∏á‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏£‡πå‡∏Ñ‡∏¥‡∏°‡∏µ‡∏î‡∏µ‡∏™</h2>
         <p class="mb-4">
          <strong>‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏£‡πå‡∏Ñ‡∏¥‡∏°‡∏µ‡∏î‡∏µ‡∏™</strong> ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ß‡πà‡∏≤ "‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏ó‡∏µ‡πà‡∏à‡∏°‡πÉ‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏°‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏£‡∏á‡∏û‡∏¢‡∏∏‡∏á (Buoyant force) ‡∏Å‡∏£‡∏∞‡∏ó‡∏≥ ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏ô‡∏±‡πâ‡∏ô‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà"
        </p>
        <div class="equation-box my-4">
            <span>F</span><sub class="text-base">B</sub>&nbsp;=&nbsp;<em>œÅ</em><sub class="text-base">‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏•</sub><em>V</em><sub class="text-base">‡∏à‡∏°</sub><em>g</em>
        </div>
        <!-- SIMULATION: Buoyancy -->
        <div class="mt-8 bg-white border border-gray-200 rounded-lg shadow-md p-4 sm:p-6">
            <h4 class="text-xl font-semibold mb-6 text-green-600">üî¨ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á: ‡πÅ‡∏£‡∏á‡∏•‡∏≠‡∏¢‡∏ï‡∏±‡∏ß</h4>
            <div class="flex flex-col lg:flex-row lg:gap-6">
                 <!-- Controls -->
                <div class="lg:w-1/3 lg:order-2 bg-white p-4 sm:p-6 rounded-xl shadow-inner mb-6 lg:mb-0">
                    <div>
                        <label class="font-medium text-sm mb-2 block">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏™‡∏î‡∏∏</label>
                        <div id="materialButtons" class="grid grid-cols-2 gap-2 text-center text-sm">
                            <button data-density="700" class="material-btn p-2 rounded-lg bg-gray-200 material-btn-active">‡πÑ‡∏°‡πâ‡∏™‡∏ô</button>
                            <button data-density="920" class="material-btn p-2 rounded-lg bg-gray-200">‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á</button>
                            <button data-density="2700" class="material-btn p-2 rounded-lg bg-gray-200">‡∏≠‡∏∞‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°</button>
                            <button data-density="7850" class="material-btn p-2 rounded-lg bg-gray-200">‡πÄ‡∏´‡∏•‡πá‡∏Å</button>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="volumeSlider" class="font-medium text-sm mb-1 block">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ (V)</label>
                        <div class="flex items-center gap-2">
                           <input type="range" id="volumeSlider" min="0.001" max="0.05" value="0.01" step="0.001" class="flex-grow">
                           <input type="number" id="volumeNumber" min="0.001" max="0.05" value="0.01" step="0.001" class="w-20 text-center border rounded-md p-1 bg-blue-50">
                           <span class="text-xs text-gray-500">m¬≥</span>
                        </div>
                    </div>
                    <hr class="my-6">
                    <div class="text-center p-3 bg-green-50 rounded-lg">
                        <h4 class="font-bold text-green-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h4>
                        <p id="buoyancyStatus" class="font-semibold text-2xl mt-1">‡∏•‡∏≠‡∏¢</p>
                    </div>
                    <div class="mt-6 space-y-2">
                         <button id="calculateBuoyancyBtn" class="w-full text-center py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-lg transition text-base">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•</button>
                        <div class="flex gap-2">
                           <button id="clearBuoyancyGraphBtn" class="w-1/2 text-center py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-800 font-bold rounded-lg transition text-sm">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü</button>
                           <button id="exportBuoyancyCsvBtn" class="w-1/2 text-center py-2 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition text-sm">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
                        </div>
                    </div>
                </div>
                <!-- Visuals -->
                <div class="lg:w-2/3 lg:order-1 space-y-4 lg:space-y-6">
                    <div class="w-full flex items-center justify-center bg-white p-4 rounded-xl shadow-inner h-72 sm:h-80 lg:min-h-[350px]">
                        <canvas id="buoyancyCanvas"></canvas>
                    </div>
                    <div class="w-full bg-white p-2 sm:p-4 rounded-xl shadow-inner h-64 sm:h-72">
                        <canvas id="buoyancyChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Footer -->
  <footer class="gradient-bg text-white py-8 mt-16" role="contentinfo">
    <div class="container mx-auto px-4 text-center">
       <p class="text-sm text-blue-300">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢: ‡∏ô‡∏≤‡∏¢‡∏ó‡∏£‡∏á‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ ‡∏™‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡∏ß ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏•‡∏≠‡∏á ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÅ‡∏û‡∏£‡πà</p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Universal Constants & Data Stores ---
        const GRAVITY = 9.81;
        let pressureExperimentData = [];
        let pascalExperimentData = [];
        let buoyancyExperimentData = [];
        let pressureChart, pascalChart, buoyancyChart;
        let pascalAnimationId, simState = { piston1Y: 0, piston2Y: 0, targetPiston1Y: 0, targetPiston2Y: 0 };

        // --- Utility Functions ---
        function exportToCSV(filename, headers, data) {
            const rows = data.map(d => d.join(','));
            const csvString = headers.join(',') + "\n" + rows.join("\n");
            const bom = '\uFEFF';
            const blob = new Blob([bom + csvString], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", filename);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function drawArrow(ctx, fromx, fromy, tox, toy, color, label = '') {
            const headlen = 10;
            const dx = tox - fromx;
            const dy = toy - fromy;
            const angle = Math.atan2(dy, dx);
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(fromx, fromy);
            ctx.lineTo(tox, toy);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(tox, toy);
            ctx.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fill();
            if (label) {
                ctx.fillStyle = '#1f2937';
                ctx.font = 'bold 14px Sarabun';
                ctx.textAlign = 'center';
                const isUpArrow = toy < fromy;
                ctx.fillText(label, tox, toy + (isUpArrow ? -15 : 20));
            }
        }

        function linkSliderAndNumber(sliderId, numberId) {
            const slider = document.getElementById(sliderId);
            const number = document.getElementById(numberId);
            if(!slider || !number) return;
            slider.addEventListener('input', () => { number.value = slider.value; slider.dispatchEvent(new Event('change', {bubbles: true})); });
            number.addEventListener('input', () => { slider.value = number.value; number.dispatchEvent(new Event('change', {bubbles: true})); });
        }

        function formatArea(area) {
            if (area === 0) return '0.00000';
            if (area < 0.0001 && area > 0) {
                return area.toExponential(2);
            }
            return area.toFixed(5);
        }
        
        // --- Simulation 1: Fluid Pressure ---
        const pressureSim = {
            canvas: document.getElementById('pressureCanvas'),
            chartCanvas: document.getElementById('pressureChart'),
            densitySlider: document.getElementById('densitySlider'),
            depthSlider: document.getElementById('depthSlider'),
            densityNumber: document.getElementById('densityNumber'),
            depthNumber: document.getElementById('depthNumber'),
            pressureDisplay: document.getElementById('pressureDisplay'),
            calculateBtn: document.getElementById('calculatePressureBtn'),
            clearBtn: document.getElementById('clearPressureGraphBtn'),
            exportBtn: document.getElementById('exportPressureCsvBtn'),
        };

        function initializePressureSim() {
            if (!pressureSim.canvas) return;
            linkSliderAndNumber('densitySlider', 'densityNumber');
            linkSliderAndNumber('depthSlider', 'depthNumber');
            const chartCtx = pressureSim.chartCanvas.getContext('2d');
            pressureChart = new Chart(chartCtx, {
                type: 'scatter',
                data: { datasets: [{
                    label: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á', data: [],
                    backgroundColor: 'rgba(59, 130, 246, 0.5)',
                }] },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô (P) ‡πÅ‡∏•‡∏∞ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (h)', font: { size: 14, family: "'Sarabun', sans-serif" } },
                    },
                    scales: {
                        x: { type: 'linear', position: 'bottom', title: { display: true, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (h) [m]' }, min: 0 },
                        y: { title: { display: true, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô (P) [kPa]' }, min: 0 }
                    }
                }
            });
            updatePressureSim();
        }

        function drawPressureSim() {
            if (!pressureSim.canvas.getContext) return;
            const ctx = pressureSim.canvas.getContext('2d');
            const W = pressureSim.canvas.width = pressureSim.canvas.parentElement.clientWidth;
            const H = pressureSim.canvas.height = pressureSim.canvas.parentElement.clientHeight;
            const rho = parseFloat(pressureSim.densitySlider.value);
            const h = parseFloat(pressureSim.depthSlider.value);
            ctx.clearRect(0, 0, W, H);
            
            const fluidColor = `rgba(96, 165, 250, ${Math.min(1, rho/2000)})`;
            const tankWidth = W * 0.7;
            const tankX = (W - tankWidth) / 2;
            const tankBottom = H * 0.9;
            const tankTop = H * 0.1;
            const waterHeight = (tankBottom - tankTop);
            ctx.fillStyle = fluidColor;
            ctx.fillRect(tankX, tankTop, tankWidth, waterHeight);
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 4;
            ctx.strokeRect(tankX, tankTop, tankWidth, waterHeight);
            const sensorY = tankTop + (h / 100) * waterHeight;
            ctx.beginPath();
            ctx.setLineDash([5, 5]);
            ctx.moveTo(tankX, sensorY);
            ctx.lineTo(tankX + tankWidth, sensorY);
            ctx.strokeStyle = '#f87171';
            ctx.lineWidth = 2;
            ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(tankX + tankWidth/2, sensorY, 5, 0, 2 * Math.PI);
            ctx.fill();
            ctx.fillStyle = '#1f2937';
            ctx.font = '14px Sarabun';
            ctx.textAlign = 'right';
            ctx.fillText('h', tankX - 10, sensorY + 5);
        }
        
        function updatePressureSim() {
            if (!pressureSim.densitySlider) return;
            const rho = parseFloat(pressureSim.densitySlider.value);
            const h = parseFloat(pressureSim.depthSlider.value);
            const pressure = rho * GRAVITY * h;
            pressureSim.pressureDisplay.textContent = `${(pressure/1000).toFixed(2)} kPa`;
            drawPressureSim();
        }

        function logPressureData() {
            const rho = parseFloat(pressureSim.densitySlider.value);
            const h = parseFloat(pressureSim.depthSlider.value);
            const pressure = rho * GRAVITY * h;
            pressureExperimentData.push([h, rho, (pressure/1000).toFixed(2)]);
            pressureChart.data.datasets[0].data.push({x: h, y: pressure/1000});
            pressureChart.update();
        }

        // --- Simulation 2: Pascal's Law ---
        const pascalSim = {
            canvas: document.getElementById('pascalCanvas'),
            chartCanvas: document.getElementById('pascalChart'),
            fSlider: document.getElementById('f_slider'),
            dSmallSlider: document.getElementById('d_small_slider'),
            dLargeSlider: document.getElementById('D_large_slider'),
            fNumber: document.getElementById('f_number'),
            dSmallNumber: document.getElementById('d_small_number'),
            dLargeNumber: document.getElementById('D_large_number'),
            aVal: document.getElementById('a_val'),
            AVal: document.getElementById('A_val'),
            pVal: document.getElementById('p_val'),
            maVal: document.getElementById('ma_val'),
            WVal: document.getElementById('W_val'),
            calculateBtn: document.getElementById('calculatePascalBtn'),
            clearBtn: document.getElementById('clearPascalGraphBtn'),
            exportBtn: document.getElementById('exportPascalCsvBtn'),
        };
        
        function initializePascalSim() {
            if (!pascalSim.canvas) return;
            linkSliderAndNumber('f_slider', 'f_number');
            linkSliderAndNumber('d_small_slider', 'd_small_number');
            linkSliderAndNumber('D_large_slider', 'D_large_number');
            const chartCtx = pascalSim.chartCanvas.getContext('2d');
            pascalChart = new Chart(chartCtx, {
                type: 'scatter',
                data: { datasets: [{
                    label: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏•‡∏≠‡∏á', data: [],
                    backgroundColor: 'rgba(59, 130, 246, 0.5)', borderColor: 'rgba(59, 130, 246, 1)',
                    borderWidth: 2, pointRadius: 5,
                }, {
                    type: 'line', label: '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ (y=x)', data: [{x: 0, y: 0}, {x: 1000, y: 1000}],
                    borderColor: 'rgba(239, 68, 68, 0.8)', borderWidth: 2,
                    pointRadius: 0, fill: false, borderDash: [5, 5],
                }] },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        title: { display: true, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏£‡∏á (W/F) ‡πÅ‡∏•‡∏∞ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (A/a)', font: { size: 14, family: "'Sarabun', sans-serif" } },
                        tooltip: { callbacks: { label: (ctx) => ctx.dataset.label === '‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏§‡∏©‡∏é‡∏µ (y=x)' ? ctx.dataset.label : [`‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (A/a): ${ctx.parsed.x.toFixed(2)}`, `‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏£‡∏á (W/F): ${ctx.parsed.y.toFixed(2)}`] } }
                    },
                    scales: {
                        x: { type: 'linear', position: 'bottom', title: { display: true, text: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (A/a)' }, min: 0 },
                        y: { title: { display: true, text: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏£‡∏á (W/F)' }, min: 0 }
                    }
                }
            });
            updatePascalSim();
        }

        function drawPascalSim() {
            if (!pascalSim.canvas.getContext) return;
            const ctx = pascalSim.canvas.getContext('2d');
            const W = pascalSim.canvas.width = pascalSim.canvas.parentElement.clientWidth;
            const H = pascalSim.canvas.height = pascalSim.canvas.parentElement.clientHeight;
            const d_small = parseFloat(pascalSim.dSmallSlider.value);
            const D_large = parseFloat(pascalSim.dLargeSlider.value);
            ctx.clearRect(0, 0, W, H);
            const groundY = H * 0.85, containerWidth = W * 0.7, containerX = (W - containerWidth) / 2;
            const fluidHeight = H * 0.3, pipeHeight = H * 0.1, pistonHeight = 15;
            const maxVisWidth = containerWidth * 0.4, maxDiameter = parseFloat(pascalSim.dLargeSlider.max);
            const p1Width = Math.max(10, (d_small / maxDiameter) * maxVisWidth), p2Width = Math.max(10, (D_large / maxDiameter) * maxVisWidth);
            const p1X = containerX + (containerWidth * 0.25) - (p1Width / 2), p2X = containerX + (containerWidth * 0.75) - (p2Width / 2);
            const fluidTopY = groundY - fluidHeight - pipeHeight;
            const fluidLvl1 = fluidTopY, fluidLvl2 = fluidTopY; // Simplified for static view
            ctx.fillStyle = '#60a5fa';
            ctx.fillRect(p1X, fluidLvl1, p1Width, groundY - fluidLvl1);
            ctx.fillRect(p2X, fluidLvl2, p2Width, groundY - fluidLvl2);
            ctx.fillRect(p1X, groundY - pipeHeight, (p2X + p2Width) - p1X, pipeHeight);
            ctx.fillStyle = '#718096';
            const p1y = fluidLvl1 - pistonHeight, p2y = fluidLvl2 - pistonHeight;
            ctx.fillRect(p1X, p1y, p1Width, pistonHeight);
            ctx.fillRect(p2X, p2y, p2Width, pistonHeight);
            const massWidth = p2Width * 0.8, massHeight = 40;
            ctx.fillStyle = '#f59e0b';
            ctx.fillRect(p2X + (p2Width - massWidth) / 2, p2y - massHeight, massWidth, massHeight);
            ctx.fillStyle = '#1f2937'; ctx.font = 'bold 16px Sarabun'; ctx.textAlign = 'center';
            ctx.fillText('M', p2X + p2Width / 2, p2y - massHeight / 2 + 6);
            drawArrow(ctx, p1X + p1Width / 2, p1y - 50, p1X + p1Width / 2, p1y - 5, '#d97706', 'F');
            drawArrow(ctx, p2X + p2Width / 2, p2y - massHeight - 5, p2X + p2Width / 2, p2y - massHeight - 50, '#16a34a', 'W');
        }

        function updatePascalSim() {
            if (!pascalSim.fSlider) return;
            const F = parseFloat(pascalSim.fSlider.value);
            const d = parseFloat(pascalSim.dSmallSlider.value);
            const D = parseFloat(pascalSim.dLargeSlider.value);
            const a = Math.PI * (d / 200) ** 2;
            const A = Math.PI * (D / 200) ** 2;
            const p = a > 0 ? F / a : 0;
            const W = p * A;
            const M = W / GRAVITY;
            const areaRatio = A > 0 && a > 0 ? A / a : 0;

            pascalSim.aVal.innerHTML = `${formatArea(a)} m¬≤`;
            pascalSim.AVal.innerHTML = `${formatArea(A)} m¬≤`;
            pascalSim.pVal.textContent = `${(p / 1000).toLocaleString('th-TH', { maximumFractionDigits: 2 })} kPa`;
            pascalSim.WVal.textContent = `${W.toLocaleString('th-TH', { maximumFractionDigits: 2 })} N`;
            pascalSim.maVal.textContent = `${areaRatio.toLocaleString('th-TH', { maximumFractionDigits: 2 })}`;
            drawPascalSim();
        }

        function logPascalData() {
            const F = parseFloat(pascalSim.fSlider.value);
            const d = parseFloat(pascalSim.dSmallSlider.value);
            const D = parseFloat(pascalSim.dLargeSlider.value);
            const a = Math.PI * (d / 200) ** 2;
            const A = Math.PI * (D / 200) ** 2;
            const W = a > 0 ? F * (A / a) : 0;
            if(a > 0 && F > 0) {
                const areaRatio = A / a;
                const forceRatio = W / F;
                pascalChart.data.datasets[0].data.push({ x: areaRatio, y: forceRatio });
                const maxVal = Math.max(...pascalChart.data.datasets[0].data.flatMap(p => [p.x, p.y]), 10) * 1.1;
                pascalChart.options.scales.x.max = maxVal;
                pascalChart.options.scales.y.max = maxVal;
                pascalChart.update();
                pascalExperimentData.push([F, d, formatArea(a), D, formatArea(A), W.toFixed(2), areaRatio.toFixed(2), forceRatio.toFixed(2), areaRatio.toFixed(2)]);
            }
        }
        
        // --- Simulation 3: Buoyancy ---
        const buoyancySim = {
            canvas: document.getElementById('buoyancyCanvas'),
            chartCanvas: document.getElementById('buoyancyChart'),
            materialButtons: document.getElementById('materialButtons'),
            volumeSlider: document.getElementById('volumeSlider'),
            volumeNumber: document.getElementById('volumeNumber'),
            statusDisplay: document.getElementById('buoyancyStatus'),
            calculateBtn: document.getElementById('calculateBuoyancyBtn'),
            clearBtn: document.getElementById('clearBuoyancyGraphBtn'),
            exportBtn: document.getElementById('exportBuoyancyCsvBtn'),
        };
        let activeMaterialBtn = buoyancySim.materialButtons ? buoyancySim.materialButtons.querySelector('.material-btn') : null;

        function initializeBuoyancySim() {
            if (!buoyancySim.canvas) return;
            linkSliderAndNumber('volumeSlider', 'volumeNumber');
            const chartCtx = buoyancySim.chartCanvas.getContext('2d');
            buoyancyChart = new Chart(chartCtx, {
                type: 'bar',
                data: { labels: [], datasets: [{ label: '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (W)', data: [], backgroundColor: '#ef4444' }, { label: '‡πÅ‡∏£‡∏á‡∏û‡∏¢‡∏∏‡∏á (F ô)', data: [], backgroundColor: '#3b82f6' }] },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { title: { display: true, text: '‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á', font: { size: 14, family: "'Sarabun', sans-serif" } } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: '‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á (N)' } } }
                }
            });
            updateBuoyancySim();
        }
        
        function drawBuoyancySim() {
            if (!buoyancySim.canvas.getContext) return;
            const ctx = buoyancySim.canvas.getContext('2d');
            const W = buoyancySim.canvas.width = buoyancySim.canvas.parentElement.clientWidth;
            const H = buoyancySim.canvas.height = buoyancySim.canvas.parentElement.clientHeight;
            const rho_obj = parseFloat(activeMaterialBtn.dataset.density);
            const rho_fluid = 1000;
            const V = parseFloat(buoyancySim.volumeSlider.value);
            ctx.clearRect(0, 0, W, H);
            const fluidBottom = H * 0.95;
            const waterLevelY = H * 0.5;
            ctx.fillStyle = 'rgba(96, 165, 250, 0.7)';
            ctx.fillRect(0, waterLevelY, W, fluidBottom - waterLevelY);
            ctx.fillStyle = '#1e3a8a';
            ctx.fillRect(0, waterLevelY, W, 3);
            const totalVolumePixels = 80000;
            const objectWidth = Math.cbrt(V / 0.05 * totalVolumePixels) * 1.5;
            const objectHeight = objectWidth / 1.5;
            const objectX = (W - objectWidth) / 2;
            const weight = rho_obj * V * GRAVITY;
            let objectBottomY;
            if (rho_obj >= rho_fluid) {
                objectBottomY = fluidBottom;
            } else {
                const submergedRatio = rho_obj / rho_fluid;
                const submergedHeight = objectHeight * submergedRatio;
                objectBottomY = waterLevelY + submergedHeight;
            }
            ctx.fillStyle = '#f59e0b';
            ctx.fillRect(objectX, objectBottomY - objectHeight, objectWidth, objectHeight);
            const objectCenterX = objectX + objectWidth / 2;
            const objectCenterY = objectBottomY - objectHeight / 2;
            const maxForce = rho_fluid * 0.05 * GRAVITY; 
            const arrowLengthScale = H / (maxForce * 2.5);
            const weightArrowLength = weight * arrowLengthScale;
            drawArrow(ctx, objectCenterX, objectCenterY, objectCenterX, objectCenterY + weightArrowLength, '#ef4444', 'W');
            const submergedVolume = (rho_obj < rho_fluid) ? (weight / (rho_fluid * GRAVITY)) : V;
            const actualBuoyantForce = submergedVolume * rho_fluid * GRAVITY;
            const buoyancyArrowLength = actualBuoyantForce * arrowLengthScale;
            drawArrow(ctx, objectCenterX, objectCenterY, objectCenterX, objectCenterY - buoyancyArrowLength, '#3b82f6', 'F ô');
        }
        
        function updateBuoyancySim() {
            if (!buoyancySim.volumeSlider) return;
            const rho_obj = parseFloat(activeMaterialBtn.dataset.density);
            let status;
            if (rho_obj > 1000) status = '‡∏à‡∏°';
            else if (rho_obj < 1000) status = '‡∏•‡∏≠‡∏¢';
            else status = '‡∏•‡∏≠‡∏¢‡∏õ‡∏£‡∏¥‡πà‡∏°';
            buoyancySim.statusDisplay.textContent = status;
            drawBuoyancySim();
        }

        function logBuoyancyData() {
            const rho_obj = parseFloat(activeMaterialBtn.dataset.density);
            const V = parseFloat(buoyancySim.volumeSlider.value);
            const rho_fluid = 1000;
            const materialName = activeMaterialBtn.textContent;
            const weight = rho_obj * V * GRAVITY;
            const maxBuoyantForce = rho_fluid * V * GRAVITY;
            const status = buoyancySim.statusDisplay.textContent;
            buoyancyExperimentData.push([materialName, rho_obj, V, weight.toFixed(2), maxBuoyantForce.toFixed(2), status]);
            const label = `${materialName.substring(0,3)}. (${V.toFixed(3)} m¬≥)`
            buoyancyChart.data.labels.push(label);
            buoyancyChart.data.datasets[0].data.push(weight);
            buoyancyChart.data.datasets[1].data.push(maxBuoyantForce);
            buoyancyChart.update();
            updateBuoyancySim();
        }

        // --- Initializers and Event Listeners ---
        if (pressureSim.canvas) {
            initializePressureSim();
            ['input', 'change'].forEach(evt => {
                pressureSim.densitySlider.addEventListener(evt, updatePressureSim);
                pressureSim.depthSlider.addEventListener(evt, updatePressureSim);
            });
            pressureSim.calculateBtn.addEventListener('click', logPressureData);
            pressureSim.clearBtn.addEventListener('click', () => {
                pressureExperimentData = [];
                pressureChart.data.datasets[0].data = [];
                pressureChart.update();
            });
            const pressureHeadersCSV = ['‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å h (m)','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô rho (kg/m^3)','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô P (kPa)'];
            pressureSim.exportBtn.addEventListener('click', () => exportToCSV('pressure_data.csv', pressureHeadersCSV, pressureExperimentData));
        }

        if (pascalSim.canvas) {
            initializePascalSim();
            ['input', 'change'].forEach(evt => {
                pascalSim.fSlider.addEventListener(evt, updatePascalSim);
                pascalSim.dSmallSlider.addEventListener(evt, updatePascalSim);
                pascalSim.dLargeSlider.addEventListener(evt, updatePascalSim);
            });
            pascalSim.calculateBtn.addEventListener('click', logPascalData);
            pascalSim.clearBtn.addEventListener('click', () => {
                pascalExperimentData = [];
                pascalChart.data.datasets[0].data = [];
                pascalChart.update();
            });
            const pascalHeadersCSV = ["‡πÅ‡∏£‡∏á‡∏Å‡∏î F (N)","‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á d (cm)","‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà a (m^2)","‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á D (cm)","‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà A (m^2)","‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å W (N)","‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà A/a","‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏£‡∏á W/F", "‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏• (M.A.)"];
            pascalSim.exportBtn.addEventListener('click', () => exportToCSV('pascal_data.csv', pascalHeadersCSV, pascalExperimentData));
        }

        if (buoyancySim.canvas) {
            initializeBuoyancySim();
            buoyancySim.materialButtons.querySelectorAll('.material-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (activeMaterialBtn) activeMaterialBtn.classList.remove('material-btn-active');
                    btn.classList.add('material-btn-active');
                    activeMaterialBtn = btn;
                    updateBuoyancySim();
                });
            });
            ['input', 'change'].forEach(evt => {
                 buoyancySim.volumeSlider.addEventListener(evt, updateBuoyancySim);
            });
            buoyancySim.calculateBtn.addEventListener('click', logBuoyancyData);
            buoyancySim.clearBtn.addEventListener('click', () => {
                buoyancyExperimentData = [];
                buoyancyChart.data.labels = [];
                buoyancyChart.data.datasets[0].data = [];
                buoyancyChart.data.datasets[1].data = [];
                buoyancyChart.update();
            });
            const buoyancyHeadersCSV = ['‡∏ß‡∏±‡∏™‡∏î‡∏∏','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏ rho_obj (kg/m^3)','‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ V (m^3)','‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å W (N)','‡πÅ‡∏£‡∏á‡∏û‡∏¢‡∏∏‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î FB_max (N)','‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'];
            buoyancySim.exportBtn.addEventListener('click', () => exportToCSV('buoyancy_data.csv', buoyancyHeadersCSV, buoyancyExperimentData));
        }
    });
  </script>
</body>
</html>

